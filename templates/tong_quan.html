{% extends "base.html" %}

{% block content %}
<div class="container" style = "font-size: small;">
    <h2 style="text-align: center;">
        {{ tieu_de }} : Th√°ng
        <span 
            onclick="document.getElementById('modal-thang').style.display='flex'"
            style="cursor: pointer; text-decoration: underline dotted; color: #007bff;"
            title="Click ƒë·ªÉ ƒë·ªïi th√°ng">
            {{ thang_hien_tai }}
        </span>
      </h2>
      <hr>
      <h3> {{ tieu_de_data1 }}</h3>
          {% if data1 %}
              <table border="1" cellpadding="4" cellspacing="0" class ="table_phan_tram_nguon_tien">
                  <tr style ="font-size: small;">
                      <th>Ngu·ªìn ti·ªÅn</th>
                      <th>ƒê·∫ßu k·ª≥</th>
                      <th>Thu</th>
                      <th>Chi</th>
                      <th>Chuy·ªÉn ƒë·ªïi</th>
                      <th>Cu·ªëi k·ª≥</th>
                  </tr>
                  {% for row in data1 %}
                  <tr>
                      <td style="font-size: x-small;">{{ row.ten_nguon }}</td>
                      <td style="text-align: right; font-size: x-small;">{{ "{:,.0f}".format(row.dau_ky) }}</td>
                      <td style="text-align: right; font-size: x-small;">{{ "{:,.0f}".format(row.thu) }}</td>
                      <td style="text-align: right; font-size: x-small;">{{ "{:,.0f}".format(row.chi) }}</td>
                      <td style="text-align: right; font-size: x-small;">{{ "{:,.0f}".format(row.chuyen_doi) }}</td>
                      <td style="text-align: right; font-size: x-small;">{{ "{:,.0f}".format(row.cuoi_ky) }}</td>
                  </tr>
                  {% endfor %}
              </table>
              
          {% else %}
              <p>Kh√¥ng c√≥ d·ªØ li·ªáu giao d·ªãch.</p>
          {% endif %}
    <hr>
    <h3>{{ tieu_de_data }}</h3> 
        {% if data %}
        {% for gd in data %}
            <div class="giao-dich {{ gd.loai_giao_dich|slugify }}">
                <a href="{{ url_for('xoa_giao_dich', id=gd.id) }}"
                    onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën xo√° giao d·ªãch {{ gd.id }}?')"
                    style="color: #888; text-decoration: none; font-size: 12px;"
                    title="Xo√° giao d·ªãch">
                        üÜî {{ gd.id }}
                </a>

                <span class="ngay">üìÖ {{ gd.ngay }}</span> 
                    {% if gd.loai_giao_dich=='Thu' %} 
                        <span class ="thu"> {{ gd.loai_giao_dich }}
                    {% elif gd.loai_giao_dich=='Chi' %}
                        <span class ="chi"> {{ gd.loai_giao_dich }}
                    {% else %}
                        <span class ="chuyendoi"> {{ gd.loai_giao_dich }}
                    {% endif %}
                </span> : {{ gd.nguon_tien_obj.ten_nguon }} ‚û°Ô∏è {{ gd.noi_den_obj.ten_nguon }}
                <span class="so-tien">{{ "{:,.0f}".format(gd.so_tien) }}‚Ç´</span>
                <span class="ghichu">{{ gd.ghi_chu or 'Kh√¥ng ghi ch√∫' }}</span>
            </div>
        {% endfor %}
        {% else %}
            <p>Kh√¥ng c√≥ d·ªØ li·ªáu giao d·ªãch.</p>
        {% endif %}
</div>

<!-- Modal ch·ªçn th√°ng -->
<div id="modal-thang" class="modal-overlay">
    <div class="modal-box">
      <h3>Nh·∫≠p th√°ng xem d·ªØ li·ªáu</h3>
      <form method="get" action="{{ url_for('tong_quan') }}">
        <input type="text" id="thang" name="thang" placeholder="VD: 04/2025" value="{{ thang_hien_tai }}" required>
        <div class="btn-group">
          <button type="submit" class="btn-submit">Xem</button>
          <button type="button" class="btn-cancel" onclick="document.getElementById('modal-thang').style.display='none'">Hu·ª∑</button>
        </div>
      </form>
    </div>
  </div>

{% endblock %}